<?php $ticketDetail = $this->getTicket(); ?>
<?php $status = $this->getStatus($ticketDetail->getStatusId()); ?>

<div class="ticket-details">
    <h2 class="editable" id="ticket-title" data-field="title">
        <?php echo $this->escapeHtml($ticketDetail->getTitle()); ?></h2>
    <div class="description editable" id="ticket-description" data-field="description">
        <?php echo htmlspecialchars_decode($ticketDetail->getDescription()); ?></div>
    <div class="assigned-details">
        <div class="assign-by editable" id="ticket-assign-by" data-field="assign_by">Assigned By:
            <?php echo $this->escapeHtml($ticketDetail->getAssignBy()); ?></div>
        <div class="assign-to editable" id="ticket-assign-to" data-field="assign_to">Assigned To:
            <?php echo $this->escapeHtml($ticketDetail->getAssignTo()); ?></div>
        <div class="status editable" id="ticket-status" data-field="status">
            Status: <span class="status-color" style="background-color: <?php echo $status->getColorCode(); ?>;"></span>
            <?php echo $this->escapeHtml($status->getLabel()); ?>
        </div>
    </div>
</div>

<?php echo $this->getChildHtml('ticketsystem.view.comment'); ?>

<script type="text/javascript">
    document.observe('dom:loaded', function () {
        var ticketId = '<?php echo $ticketDetail->getId(); ?>';
        var formKey = '<?php echo Mage::getSingleton('core/session')->getFormKey(); ?>';
        var ticketEditor = new TicketEditor(
            ticketId,
            '<?php echo $this->getUrl('*/*/edit') ?>',
            formKey,
        );
    });
</script>